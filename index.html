<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Ultra" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abril+Fatface" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" media="screen" title="no title">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script type="text/javascript" src="./WURFL.js"></script>
    <title></title>
  </head>
  <body class=''>
    <div class="bkg-img">
      <div class="header">
        <div class="artwork-by-color">
          <a id="menuToggle" href="#"><i class="hamburger"></i><span>ARTWORK BY COLOR</span></a>
        </div>
        <div class="logo">
          <img src="icon.png" alt="" />
        </div>
        <div class="cart">
          <div class="diamond">
            <span>0</span>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="slider1">

        </div>
        <div class="slider2">

        </div>
        <div class="textile">

        </div>
        <div class="footer">
          <div class="footer-img">

          </div>
        </div>
      </div>

      <nav id="colorNav">
        <h6 id='close'>CLOSE</h6>
        <div class="title">
            <h1>ARTWORK BY COLOR</h1>
            <span class="line"></span>
        </div>
        <div class="videos">
          <a class="indigo-link" href="#">

            <div class="video" onclick="this.children[0].play();">
              <!-- webkit-playsinline autoplay -->
              <video id='video1' webkit-playsinline autoplay loop src="" type="video/mp4" data-device="desktop"></video>
              <img class='gif' src="" alt="indigo" data-still="indigo.jpg" data-giff="indigo.gif"/>
              <svg viewBox="0 0 400 200">
                <mask id="indigo" x="0" y="0" width="100%" height="100%" >
                    <rect x="0" y="0" width="100%" height="100%" fill="#fff"/>
                    <text class="indigo-text" >

                      <tspan dy="0.75em" x="90">INDIGO</tspan>

                    </text>
                  </mask>
                <rect class='indigo-rect' x="0" y="0" width="100%" height="100%" fill="#fff" mask="url(#indigo)"/>
              </svg>
            </div>
          </a>
          <a class="rose-link" href="#">

            <div class="video" onclick="this.children[0].play();" >
              <!-- webkit-playsinline autoplay -->
              <video id='video2' webkit-playsinline autoplay loop src="" type="video/mp4" data-device="desktop"></video>
              <img class='gif' src="" alt="rose" data-still="rose.jpg" data-giff="rose.gif"/>
              <svg viewBox="0 0 400 200">
                <mask id="rose" x="0" y="0" width="100%" height="100%" >
                    <rect x="0" y="0" width="100%" height="100%" fill="#fff"/>
                    <text class="burg-text" >

                      <tspan dy="0.75em" x="120">ROSE</tspan>
                    </text>
                  </mask>
                <rect x="0" y="0" width="100%" height="100%" fill="#fff" mask="url(#rose)"/>
              </svg>
            </div>
          </a>
        </div>

        <div class="bottom-nav">
          <a id='about' href="#">ABOUT</a>
          <a href="#">CONTACT</a>
          <a href="#">BLOG</a>
          <a href="#">SEARCH</a>
          <a href="#">ACCOUNT</a>
        </div>

      </nav>
    </div>

    <script>
    (function () {

      window.addEventListener('load', function(){

        var colorMenu = document.getElementById('menuToggle');
        var colorNav = document.getElementById('colorNav');
        var close = document.getElementById('close');
        var bod = document.querySelector('body')

        colorMenu.addEventListener('click', function(){
          colorNav.style.display = 'block'
          bod.classList.add('modal-open')
        })

        close.addEventListener('click', function(){
          colorNav.style.display = 'none'
          bod.classList.remove('modal-open')
        })


        // window.addEventListener('resize', function(){
        //   if(document.body.clientWidth >= 769) {
        //
        //       if(vid1.dataset.device === 'mobile') {
        //         vidArr.forEach(function(vid){
        //           vid.setAttribute("autoplay", '' )
        //           vid.dataset.device = "desktop"
        //         })
        //         vid1.src = 'indigo.mp4'
        //         vid2.src = 'rose.mp4'
        //
        //     }
        //
        //   } else {
        //     if(vid1.dataset.device !== 'mobile') {
        //
        //         vidsArr.forEach(function(vid, i){
        //           vid.src = ''
        //           vid.dataset.device = "mobile"
        //           gif[i].src = gif[i].dataset.still
        //         })
        //     }
        //   }
        // })
        //
        // if(document.body.clientWidth >= 769) {
        //   vidArr.forEach(function(vid){
        //     vid.dataset.device = "desktop"
        //   })
        //
        // } else {
        //   vidArr.forEach(function(vid, i){
        //     vid.src = ''
        //     vid.dataset.device = "mobile"
        //     gif[i].src = gif[i].dataset.still
        //   })
        // }


      })

      var vidArr = Array.from(document.querySelectorAll('.video video'))
      var gifArr = Array.from(document.querySelectorAll('.gif'))
      var colors = Array.from(document.querySelectorAll('.video tspan'))

      /**
      * Dynamically loads the src of the img or video tag we decide to use based on device
      * --- *
      * @param array of elements to have their src loaded.
      * @param array of elements to hide.
      * @param string ie. '.gif' or '.mp4' depending on what media we are loading.
      */
      function loadSrc(ArrayToLoad, ArrayToHide, extensionString) {
        ArrayToHide.forEach(function(element){
          element.style.display = "none"
        })

        ArrayToLoad.forEach(function(element, i){
          element.src = colors[i].innerHTML.toLowerCase() + extensionString
        })
      }

      if (WURFL.is_mobile === true && WURFL.form_factor === "Smartphone") {
        loadSrc(gifArr, vidArr, '.gif')
      } else  {
        loadSrc(vidArr, gifArr, '.mp4')
      }
    })();
    </script>
  </body>
</html>
